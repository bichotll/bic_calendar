/*
 *  Bic Calendar - v3.2.2
 *  A simple twitter bootstrap calendar / agenda to mark events and select range of dates.
 *  http://bichotll.github.io/bic_calendar
 *
 *  Made by bichotll
 *  Under Apache License
 */
 $.fn.bic_calendar=function(a){var b=$.extend({},$.fn.bic_calendar.defaults,a);return this.each(function(){function y(){d=$('<table class="table">'),A();var b=i.getMonth(),h=i.getFullYear();B(b,h);var j=$('<td><a href="#" class="button-month-next"><i class="glyphicon glyphicon-arrow-right" ></i></a></td>');j.click(function(a){a.preventDefault(),b=(b+1)%12,0==b&&h++,z(b,h)});var k=$('<td><a href="#" class="button-month-previous"><i class="glyphicon glyphicon-arrow-left" ></i></a></td>');k.click(function(a){a.preventDefault(),b-=1,b==-1&&(h--,b=11),z(b,h)});var l=$('<td><a href="#" class="button-year-next"><i class="glyphicon glyphicon-arrow-right" ></i></a></td>');l.click(function(a){a.preventDefault(),h++,z(b,h)});var m=$('<td><a href="#" class="button-year-previous"><i class="glyphicon glyphicon-arrow-left" ></i></a></td>');m.click(function(a){a.preventDefault(),h--,z(b,h)});var n=$('<table class="table header"></table>');if(t===!0){var o=$("<tr></tr>"),p=$('<td colspan=5 class="monthAndYear span6"></td>');o.append(m),o.append(p),o.append(l),p.append(f),n.append(o)}if(s===!0){var q=$("<tr></tr>"),r=$('<td colspan=5 class="monthAndYear span6"></td>');q.append(k),q.append(r),q.append(j),r.append(e),n.append(q)}c=$('<div class="bic_calendar row" id="'+g+'" ></div>'),c.prepend(n),c.append(d),a.append(c),G(b,h),I()}function z(a,b){d.empty(),A(),B(a,b),G(a,b),J()}function A(){if(0!=m){var a=$('<tr class="days-month" >'),b="";$(k).each(function(a,c){b+="<td",0==a&&(b+=' class="first"'),6==a&&(b+=' class="sunday last"'),b+=">"+c+"</td>"}),b+="</tr>",a.append(b),d.append(a)}}function B(a,b){e.text(l[a]),f.text(b);for(var c=1,h=C(1,a,b),i=E(a,b),j=a+1,k="",m=0;m<7;m++){if(m<h){var n="";0==m&&(n+="<tr>"),n+='<td class="invalid-day week-day-'+m+'"',n+='"></td>'}else{var n="";0==m&&(n+="<tr>"),n+='<td id="'+g+"_"+c+"_"+j+"_"+b+'" data-date="'+j+"/"+c+"/"+b+'" ',n+=' class="day week-day-'+m+'"',n+="><div><a>"+c+"</a></div></span>",6==m&&(n+="</tr>"),c++}k+=n}for(var o=1;c<=i;){var n="";o%7==1&&(n+="<tr>"),n+='<td id="'+g+"_"+c+"_"+j+"_"+b+'" data-date="'+j+"/"+c+"/"+b+'" ',n+=' class="day week-day-'+(o-1)%7+'"',n+="><div><a>"+c+"</a></div></td>",o%7==0&&(n+="</tr>"),c++,o++,k+=n}if(o--,o%7!=0){n="";for(var m=o%7+1;m<=7;m++){var n="";n+="<td ",n+=' class="invalid-day week-day-'+(m-1)+'"',n+='"></td>',7==m&&(n+="</tr>"),k+=n}}d.append(k)}function C(a,b,c){var d=new Date(c,b,a),e=d.getDay();return e+=u,0==e?e=6:e--,e}function D(a,b,c){return a>0&&a<13&&c>0&&c<32768&&b>0&&b<=new Date(c,a,0).getDate()}function E(a,b){for(var c=28;D(a+1,c+1,b);)c++;return c}function G(a,b){0!=p?$.ajax({type:p.type,url:p.url,data:{mes:a+1,ano:b},dataType:"json"}).done(function(c){"undefined"==typeof h&&(h=[]),$.each(c,function(a,b){h.push(c[a])}),H(a,b)}):H(a,b)}function H(a,b){for(var c=a+1,d=0;d<h.length;d++)if(h[d].date.split("/")[1]==c&&h[d].date.split("/")[2]==b){var e=$("#"+g+"_"+h[d].date.replace(/\//g,"_")),f=$("#"+g+"_"+h[d].date.replace(/\//g,"_")+" a");e.addClass("event"),f.attr("data-original-title",h[d].title),h[d].color&&e.css("background",h[d].color),"undefined"!=typeof h[d].link&&""!=h[d].link&&f.attr("href",h[d].link),"undefined"!=typeof h[d].linkTarget&&""!=h[d].linkTarget&&f.attr("target",h[d].linkTarget),h[d].class&&e.addClass(h[d].class),h[d].content?(e.addClass("event_popover"),f.attr("rel","popover"),f.attr("data-content",h[d].content)):(e.addClass("event_tooltip"),f.attr("rel","tooltip"))}$("#"+g+" .event_tooltip a").tooltip(o),$("#"+g+" .event_popover a").popover(n),$(".manual_popover").click(function(){$(this).popover("toggle")})}function I(){if(1==q){a.on("click","td.day",function(){if(1==r)if(""==x)x=$(this).data("date"),J();else if(""==w){v=x,w=$(this).data("date"),J();var b=new CustomEvent("bicCalendarSelect",{detail:{dateFirst:v,dateLast:w}});document.dispatchEvent(b)}else v="",w="",x="",a.find(".selection").removeClass("middle-selection selection first-selection last-selection"),$(".bic_calendar .day a").css("cursor","pointer");else{a.find("td div").removeClass("selection"),$(this).find("div").addClass("selection");var b=new CustomEvent("bicCalendarSelect",{detail:{date:$(this).data("date")}});document.dispatchEvent(b)}})}}function J(){if(""!=x&&""==v){var b=x.split("/");$("#bic_calendar_"+b[1]+"_"+b[0]+"_"+b[2]+" div").addClass("selection")}else if(""!=v){v.split("/"),w.split("/");a.find("td.selection").removeClass("selection");var e=new Date(v),f=new Date(w);if(e>f){var g=e;e=f,f=g}for($("#bic_calendar_"+e.getDate()+"_"+(parseInt(e.getMonth())+1)+"_"+e.getFullYear()+" div").addClass("selection first-selection");e<f;)e.setDate(e.getDate()+1),$("#bic_calendar_"+e.getDate()+"_"+(parseInt(e.getMonth())+1)+"_"+e.getFullYear()+" div").addClass("selection middle-selection");$("#bic_calendar_"+e.getDate()+"_"+(parseInt(e.getMonth())+1)+"_"+e.getFullYear()+" div").removeClass("middle-selection").addClass("selection last-selection"),$(".bic_calendar .day a").css("cursor","default")}}var c,d,i,a=$(this),e=$('<div class="visualmonth"></div>'),f=$('<div class="visualyear"></div>'),g="bic_calendar",h=b.events;if(b.date)if("string"==typeof b.date){var j=b.date.split("/");i=new Date(parseInt(j[2]),parseInt(j[1])-1,parseInt(j[0]))}else i=b.date;else i=new Date;var k;k="undefined"!=typeof b.dayNames?b.dayNames:["l","m","x","j","v","s","d"];var l;l="undefined"!=typeof b.monthNames?b.monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];var m;m="undefined"==typeof b.showDays||b.showDays;var n;n="undefined"!=typeof b.popoverOptions?b.popoverOptions:{placement:"bottom",html:!0,trigger:"hover"};var o;o="undefined"!=typeof b.tooltipOptions?b.tooltipOptions:{placement:"bottom",trigger:"hover"};var p;p="undefined"!=typeof b.reqAjax&&b.reqAjax;var q=!1;"undefined"!=typeof b.enableSelect&&(q=b.enableSelect);var r=!1;"undefined"!=typeof b.multiSelect&&(r=b.multiSelect);var s=!0;"undefined"!=typeof b.displayMonthController&&(s=b.displayMonthController);var t=!0;"undefined"!=typeof b.displayYearController&&(t=b.displayYearController);var u=0;"undefined"!=typeof b.startWeekDay&&(u=b.startWeekDay);var v="",w="",x="";y()}),this};
